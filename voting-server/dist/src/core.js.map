{"version":3,"sources":["../../src/core.js"],"names":["setEntries","next","vote","INITIAL_STATE","state","entries","set","get","concat","getWinners","size","remove","first","newState","merge","take","skip","console","log","a","b","countA","getIn","countB","updateIn","value"],"mappings":";;;;;;;ypBAAA;;;;;QAOgBA,U,GAAAA,U;QAIAC,I,GAAAA,I;QAyBAC,I,GAAAA,I;;AAjChB;;AAEO,IAAMC,wCAAgB,qBAAtB;;AAEA,SAASH,UAAT,CAAoBI,KAApB,EAA0BC,OAA1B,EAAkC;AACrC,WAAOD,MAAME,GAAN,CAAU,SAAV,EAAoB,qBAAKD,OAAL,CAApB,CAAP;AACH;;AAEM,SAASJ,IAAT,CAAcG,KAAd,EAAoB;AACvB,QAAMC,UAAUD,MAAMG,GAAN,CAAU,SAAV,EAAqBC,MAArB,CAA4BC,WAAWL,MAAMG,GAAN,CAAU,MAAV,CAAX,CAA5B,CAAhB;AACA,QAAGF,QAAQK,IAAR,KAAiB,CAApB,EAAuB;AACnB,eAAON,MAAMO,MAAN,CAAa,SAAb,EAAwBA,MAAxB,CAA+B,MAA/B,EAAuCL,GAAvC,CAA2C,QAA3C,EAAqDD,QAAQO,KAAR,EAArD,CAAP;AACH;;AAED,QAAIC,WAAWT,MAAMU,KAAN,CAAY;AACvB,gBAAO,oBAAI,EAAC,QAAOT,QAAQU,IAAR,CAAa,CAAb,CAAR,EAAJ,CADgB;AAEvB,mBAAUV,QAAQW,IAAR,CAAa,CAAb;AAFa,KAAZ,CAAf;;AAKAC,YAAQC,GAAR,CAAYL,QAAZ;AACA,WAAOA,QAAP;AACH;;AAED,SAASJ,UAAT,CAAoBP,IAApB,EAAyB;AACrB,QAAG,CAACA,IAAJ,EAAU,OAAO,EAAP;;AADW,oBAIPA,KAAKK,GAAL,CAAS,MAAT,CAJO;AAAA;AAAA,QAIdY,CAJc;AAAA,QAIZC,CAJY;;AAKrB,QAAMC,SAASnB,KAAKoB,KAAL,CAAW,CAAC,OAAD,EAASH,CAAT,CAAX,EAAuB,CAAvB,CAAf;AACA,QAAMI,SAASrB,KAAKoB,KAAL,CAAW,CAAC,OAAD,EAASF,CAAT,CAAX,EAAuB,CAAvB,CAAf;AACA,WAAOG,SAASF,MAAT,GAAkBD,CAAlB,GAAuBC,WAAWE,MAAX,GAAoB,CAACJ,CAAD,EAAGC,CAAH,CAApB,GAA4BD,CAA1D;AACH;;AAEM,SAASjB,IAAT,CAAcE,KAAd,EAAoBF,IAApB,EAAyB;AAC5B,WAAOE,MAAMoB,QAAN,CAAe,CAAC,OAAD,EAAStB,IAAT,CAAf,EAA8B,CAA9B,EAAgC,UAACuB,KAAD;AAAA,eAASA,QAAM,CAAf;AAAA,KAAhC,CAAP;AACH","file":"core.js","sourcesContent":["/**\r\n * Created by Owner on 1/6/2017.\r\n */\r\nimport {List,Map} from 'immutable';\r\n\r\nexport const INITIAL_STATE = Map();\r\n\r\nexport function setEntries(state,entries){\r\n    return state.set(\"entries\",List(entries));\r\n}\r\n\r\nexport function next(state){\r\n    const entries = state.get(\"entries\").concat(getWinners(state.get(\"vote\")));\r\n    if(entries.size === 1) {\r\n        return state.remove(\"entries\").remove(\"vote\").set(\"winner\", entries.first());\r\n    }\r\n\r\n    let newState = state.merge({\r\n        \"vote\":Map({\"pair\":entries.take(2)}),\r\n        \"entries\":entries.skip(2)\r\n    });\r\n\r\n    console.log(newState);\r\n    return newState;\r\n}\r\n\r\nfunction getWinners(vote){\r\n    if(!vote) return [];\r\n\r\n\r\n    const [a,b] = vote.get(\"pair\");\r\n    const countA = vote.getIn([\"tally\",a],0);\r\n    const countB = vote.getIn([\"tally\",b],0);\r\n    return countB > countA ? b : (countA === countB ? [a,b] : a);\r\n}\r\n\r\nexport function vote(state,vote){\r\n    return state.updateIn([\"tally\",vote],0,(value)=>value+1);\r\n}\r\n"]}